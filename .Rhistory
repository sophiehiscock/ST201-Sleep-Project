#dat<-read.csv("sleepedit.csv",header=T) #pre-edited data, without aliased coefficients
dat<-read.csv("sleepcut.csv", header=T) #missing first 10 rows so we can test with this later
setwd("~/ST201-Sleep-Project")
#dat<-read.csv("sleepedit.csv",header=T) #pre-edited data, without aliased coefficients
dat<-read.csv("sleepcut.csv", header=T) #missing first 10 rows so we can test with this later
#LINEARITY?
m3.stdres<- rstandard(m3)
m3<-lm(CognitionZscore~ WeekdayRise+StressScore+ClassesMissed+EarlyClass*ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
#LINEARITY?
m3.stdres<- rstandard(m3)
with(dat, plot(GPA, m3.stdres))
with(dat, plot(StressScore, m3.stdres))
with(dat, plot(WeekdayRise, m3.stdres))
with(dat, plot(ClassesMissed, m3.stdres))
with(dat, plot(GPA, m3.stdres))
with(dat, plot(EarlyClass*ClassesMissed, m3.stdres))
with(dat, plot(ClassesMissed, m3.stdres))
with(dat, plot(WeekdayRise, m3.stdres))
with(dat, plot(StressScore, m3.stdres))
with(dat, plot(WeekdayRise, m3.stdres))
with(dat, plot(StressScore, m3.stdres))
with(dat, plot(GPA, m3.stdres))
#NORMALITY?
#histogram
hist(m3.stdres)
plot(density(m2.stdres))
plot(density(m3.stdres))
#CONSTANT VARIANCE?
plot(m3, which=c(1))
#INDEPENDENCE?
plot(m3.stdres)
#COLLINEARITY?
#correlation matrix, >|0.8|?
dtf <- subset(dat, select = c(WeekdayRise,StressScore,ClassesMissed,EarlyClass*ClassesMissed+GPA,EarlyClass,NumEarlyClass,Gender))
#COLLINEARITY?
#correlation matrix, >|0.8|?
dtf <- subset(dat, select = c(WeekdayRise,StressScore,ClassesMissed,EarlyClass*ClassesMissed+GPA,EarlyClass,NumEarlyClass,Gender))
#COLLINEARITY?
#correlation matrix, >|0.8|?
dtf <- subset(dat, select = c(WeekdayRise,StressScore,ClassesMissed,EarlyClass*ClassesMissed,GPA,EarlyClass,NumEarlyClass,Gender))
#COLLINEARITY?
#correlation matrix, >|0.8|?
dtf <- subset(dat, select = c(WeekdayRise,StressScore,GPA,EarlyClass,NumEarlyClass,Gender))
cor(dat$EarlyClass*dat$ClassesMissed,dtf)
vif(m3)
library(car)
vif(m3)
#AverageSleep
full4<-lm(CognitionZscore~AverageSleep+ClassYear+NumEarlyClass+StressScore+ClassesMissed+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
m4<-lm(CognitionZscore~ NumEarlyClass+StressScore+ClassesMissed+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
#LINEARITY?
m4.stdres<- rstandard(m4)
with(dat, plot(GPA, m4.stdres))
with(dat, plot(StressScore, m4.stdres))
with(dat, plot(ClassesMissed, m4.stdres))
with(dat, plot(EarlyClass*ClassesMissed, m3.stdres))
#NORMALITY?
#histogram
hist(m3.stdres)
#NORMALITY?
#histogram
hist(m4.stdres)
plot(density(m4.stdres))
#CONSTANT VARIANCE?
plot(m4, which=c(1))
#INDEPENDENCE?
plot(m4.stdres)
#COLLINEARITY?
#correlation matrix, >|0.8|?
dtf <- subset(dat, select = c(StressScore,ClassesMissed,GPA,EarlyClass,NumEarlyClass,Gender))
cor(dtf[sapply(dtf, is.numeric)])
#NumEarlyClass and EarlyClass 0.80894923
cor(dat$GPA,dat$ClassesMissed) #problematically correlated:0.808949226
cor(dat$NumEarlyClass,dat$EarlyClass) #not problematically correlated:-0.1728787
library(car)
vif(m4)
cor(dat$EarlyClass*dat$ClassesMissed,dtf) #no problems
cor(dat$EarlyClass*dat$ClassesMissed,dtf) #no problems
cor(dat$GPA,dat$ClassesMissed) #problematically correlated:0.808949226
cor(dat$NumEarlyClass,dat$EarlyClass) #not problematically correlated:-0.1728787
cor(dat$GPA,dat$ClassesMissed) #problematically correlated:0.808949226
cor(dat$NumEarlyClass,dat$EarlyClass) #not problematically correlated:-0.1728787
#-ClassesMissed
full5<-lm(CognitionZscore~AverageSleep+ClassYear+NumEarlyClass+StressScore+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
anova(full4,m4)
anova(full5,m4)
#AverageSleep
full4<-lm(CognitionZscore~AverageSleep+ClassYear+NumEarlyClass+StressScore+ClassesMissed+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
anova(full4,m4)
#-ClassesMissed
full5<-lm(CognitionZscore~AverageSleep+ClassYear+NumEarlyClass+StressScore+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
anova(full5,m4)
#-ClassesMissed
full5<-lm(CognitionZscore~ClassYear+NumEarlyClass+StressScore+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
anova(full5,m4)
#-ClassesMissed
full5<-lm(CognitionZscore~NumEarlyClass+StressScore+ClassesMissed+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
#-ClassesMissed
full5<-lm(CognitionZscore~NumEarlyClass+StressScore+EarlyClass*ClassesMissed+GPA+EarlyClass+Gender,  data=dat)
anova(full5,m4)
#-ClassesMissed
full5<-lm(CognitionZscore~NumEarlyClass+StressScore+GPA+EarlyClass+Gender,  data=dat)
anova(full5,m4)
