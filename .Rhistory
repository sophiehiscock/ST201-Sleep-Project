setwd("~/ST201-Sleep-Project")
#dat<-read.csv("sleepedit.csv",header=T) #pre-edited data, without aliased coefficients
dat<-read.csv("sleepcut.csv", header=T) #missing first 10 rows so we can test with this later
head(dat)
#DepressionScore
m12<-lm(CognitionZscore~ DepressionScore, data=dat)
m12.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m12),2),Lev=round(hatvalues(m12),2),Cooks=round(cooks.distance(m12),2)))
write.csv(m12.outliers,row.names = FALSE,"DepressionScore.outliers.csv")
#AnxietyScore
m13<-lm(CognitionZscore~ AnxietyScore, data=dat)
m13.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m13),2),Lev=round(hatvalues(m13),2),Cooks=round(cooks.distance(m13),2)))
write.csv(m13.outliers,row.names = FALSE,"AnxietyScore.outliers.csv")
#StressScore
m14<-lm(CognitionZscore~ StressScore, data=dat)
m14.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m14),2),Lev=round(hatvalues(m14),2),Cooks=round(cooks.distance(m14),2)))
write.csv(m14.outliers,row.names = FALSE,"StressScore.outliers.csv")
#WeekdayBed
m15<-lm(CognitionZscore~ WeekdayBed, data=dat)
m13.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m15),2),Lev=round(hatvalues(m15),2),Cooks=round(cooks.distance(m15),2)))
write.csv(m15.outliers,row.names = FALSE,"WeekdayBed.outliers.csv")
#WeekdayRise
m16<-lm(CognitionZscore~ WeekdayRise, data=dat)
m16.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m16),2),Lev=round(hatvalues(m16),2),Cooks=round(cooks.distance(m16),2)))
write.csv(m16.outliers,row.names = FALSE,"WeekdayRise.outliers.csv")
#WeekendBed
m17<-lm(CognitionZscore~ WeekendBed, data=dat)
m17.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m17),2),Lev=round(hatvalues(m17),2),Cooks=round(cooks.distance(m17),2)))
write.csv(m17.outliers,row.names = FALSE,"WeekendBed.outliers.csv")
#WeekendRise
m18<-lm(CognitionZscore~ WeekendRise, data=dat)
m18.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m18),2),Lev=round(hatvalues(m18),2),Cooks=round(cooks.distance(m18),2)))
write.csv(m18.outliers,row.names = FALSE,"WeekendRise.outliers.csv")
onZscore~ WeekdayBed, data=dat)
m15.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m15),2),Lev=round(hatvalues(m15),2),Cooks=round(cooks.distance(m15),2)))
write.csv(m15.o
#WeekdayBed
m15<-lm(CognitionZscore~ WeekdayBed, data=dat)
#WeekdayBed
m15<-lm(CognitionZscore~ WeekdayBed, data=dat)
m15.outliers<-data.frame(Stand.Res=cbind(round(rstandard(m15),2),Lev=round(hatvalues(m15),2),Cooks=round(cooks.distance(m15),2)))
write.csv(m15.outliers,row.names = FALSE,"WeekdayBed.outliers.csv")
#suggests WeekdayRise DepressionStatusSevere StressScore ClassesMissed GPA EarlyClass NumEarlyClass Gender
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus)+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
summary(msubsets) #looks good based on R squared value
#suggests WeekdayRise DepressionStatusSevere StressScore ClassesMissed GPA EarlyClass NumEarlyClass Gender
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus)-factor(DepressionStatus)normal+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
summary(mbackward) #this model looks really good!!! all variables significant :)
#suggests WeekdayRise DepressionStatusSevere StressScore ClassesMissed GPA EarlyClass NumEarlyClass Gender
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus):severe+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
#dat<-read.csv("sleepedit.csv",header=T) #pre-edited data, without aliased coefficients
dat<-read.csv("sleepcut.csv", header=T) #missing first 10 rows so we can test with this later
head(dat)
#subset
install.packages('leaps')
#suggests WeekdayRise DepressionStatusSevere StressScore ClassesMissed GPA EarlyClass NumEarlyClass Gender
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus):severe+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
#suggests WeekdayRise DepressionStatusSevere StressScore ClassesMissed GPA EarlyClass NumEarlyClass Gender
DepressionStatus$severe<-data.frame
#suggests WeekdayRise DepressionStatusSevere StressScore ClassesMissed GPA EarlyClass NumEarlyClass Gender
DepressionStatus$severe<-data.frame(data=dat)
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus, exclude ='severe'):severe+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus, exclude =c('severe'):severe+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus, exclude =c('severe')+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus, exclude =c('severe')+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
summary(msubsets) #looks good based on R squared value
summary(msubsets) #looks good based on R squared value
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus, exclude =c('factor(DepressionStatus)normal')+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
summary(msubsets) #looks good based on R squared value
summary(msubsets) #looks good based on R squared value
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus, exclude =c('factor(DepressionStatus)normal'))+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
summary(msubsets) #looks good based on R squared value
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus, exclude =c('normal'))+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
summary(msubsets) #looks good based on R squared value
msubsets<-lm(CognitionZscore~ WeekdayRise +factor(DepressionStatus)+StressScore+ClassesMissed+GPA+EarlyClass+NumEarlyClass+Gender, data=dat)
summary(msubsets) #looks good based on R squared value
#lm(formula = CognitionZscore ~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore, data = dat)
mbackward<-lm(CognitionZscore ~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore, data = dat)
summary(mbackward) #this model looks really good!!! all variables significant :)
summary(msubsets) #looks good based on R squared value
#LINEARITY?
m1.stdres<- rstandard(m1)
#starting point of backwards stepwise
m1<-lm(CognitionZscore ~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore, data = dat)
#LINEARITY?
m1.stdres<- rstandard(m1)
<- rstandard(m1)
par(mfrow=c(2,2)
with(dat, plot(Gender, m1.stdres))
with(dat, plot(NumEarlyClass, m1.stdres))
with(dat, plot(EarlyClass, m1.stdres))
with(dat, plot(GPA, m1.stdres))
with(dat, plot(StressScore, m1.stdres))
with(dat, plot(GPA, m1.stdres))
with(dat, plot(EarlyClass, m1.stdres))
with(dat, plot(NumEarlyClass, m1.stdres))
with(dat, plot(Gender, m1.stdres))
with(dat, plot(GPA, m1.stdres))
with(dat, plot(StressScore, m1.stdres))
stdres<- rstandard(m1)
with(dat, plot(GPA, m1.stdres))
with(
with(dat, plot(StressScore, m1.stdres))
with(dat, plot(GPA, m1.stdres))
with(dat, plot(StressScore, m1.stdres))
with(dat, plot(GPA, m1.stdres))
#NORMALITY?
hist(m1.stdres)
plot(density(m1.stdres))
#Q-Q plot
plot(m1,which=c(2))
#Q-Q plot
plot(m1,which=c(2))
#Q-Q plot
plot(m1)
#Q-Q plot
plot(m1)
#P-P plot
probDist <- pnorm(m1.stdres)
plot(ppoints(length(standardizedResiduals)), sort(probDist), main = “PP Plot”, xlab = “Observed Probability”, ylab = “Expected Probability”)
plot(ppoints(length(m1.stdres)), sort(probDist), main = “PP Plot”, xlab = “Observed Probability”, ylab = “Expected Probability”)
plot(ppoints(length(m1.stdres)), sort(probDist), main = 'PP Plot', xlab = 'Observed Probability', ylab = 'Expected Probability')
#CONSTANT VARIANCE?
plot(m1.stdres, which=c(1))
#CONSTANT VARIANCE?
plot(m1, which=c(1))
#CONSTANT VARIANCE?
plot(m1, which=c(1))
#Q-Q plot
plot(m1, which=c(2))
#CONSTANT VARIANCE?
plot(m1, which=c(1))
#INDEPENDENCE?
plot(m1.stdres)
#COLLINEARITY?
#correlation matrix, >|0.8|?
#scatterplot matrix
plot(pairs)
#COLLINEARITY?
#correlation matrix, >|0.8|?
#scatterplot matrix
pairs(~Gender + NumEarlyClass + EarlyClass + GPA + StressScore)
#COLLINEARITY?
#correlation matrix, >|0.8|?
#scatterplot matrix
pairs(~Gender + NumEarlyClass + EarlyClass + GPA + StressScore, data=dat)
#COLLINEARITY?
#correlation matrix, >|0.8|?
#scatterplot matrix
pairs(~GPA + StressScore, data=dat)
#VIF, >10? serious problem
vif(m1)
library(car)
vif(m1)
#COLLINEARITY?
#correlation matrix, >|0.8|?
cor(dat)
#COLLINEARITY?
#correlation matrix, >|0.8|?
cor(dat-DASScore)
#COLLINEARITY?
#correlation matrix, >|0.8|?
cor(m1)
#COLLINEARITY?
#correlation matrix, >|0.8|?
cor(dat$StressScore,dat$GPA)
#Partial F test
full1<-lm(CognitionZScore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore,  data=dat)
#Partial F test
full1<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore,  data=dat)
anova(m1,full)
anova(m1,full1)
#Partial F test
full1<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ factor(DepressionStatus),  data=dat)
anova(m1,full1)
#Partial F test
full1<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ DepressionStatus,  data=dat)
anova(m1,full1)
summary(m1) #this model looks really good!!! all variables significant :)
#WeekdayRise
full2<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ WeekdayRise,  data=dat)
anova(m1, full2)
#StressScore
full3<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ StressScore,  data=dat)
anova(m1, full3)
#CLassesMissed
full3<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ ClassesMissed,  data=dat)
anova(m1, full3)
#AnxietyStatus
full4<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ AnxietyStatus,  data=dat)
anova(m1,full4)
head(dat)
#Gender*ClassYear
full5<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ ClassYear + Gender*ClassYear,  data=dat)
anova(m1,full5)
#Gender*ClassYear
full5<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ ClassYear,  data=dat)
anova(m1,full5)
#GPA*Gender
full6<-lm(CognitionZscore~ Gender + NumEarlyClass + EarlyClass + GPA + StressScore+ GPA*Gender,  data=dat)
anova(m1,full6)
